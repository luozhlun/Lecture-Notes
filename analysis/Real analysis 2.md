- [Chapter 2 Integration](#chapter-2-integration)
  - [2.1 Measurable functions](#21-measurable-functions)
    - [2.1.1 Real/Complex-valued functions](#211-realcomplex-valued-functions)
    - [2.1.2 Simple Functions](#212-simple-functions)
    - [2.1.3 Complete Measures](#213-complete-measures)
  - [2.2 Integration of non-negative functions](#22-integration-of-non-negative-functions)
    - [2.2.1 Non-negative simple functions](#221-non-negative-simple-functions)
    - [2.2.2 Non-negative measurable functions](#222-non-negative-measurable-functions)
  - [2.3 Integration of complex functions](#23-integration-of-complex-functions)
    - [2.3.1 The space Tilde $L^1$](#231-the-space-tilde-l1)
    - [2.3.2 The space $L^1$](#232-the-space-l1)
  - [2.4 Modes of convergence](#24-modes-of-convergence)

Ref:

1. [Real Variable Function Ch.1 Set Theory](https://zhuanlan.zhihu.com/p/473263173)
2. [Real Variable Function Ch.2 Lebesgue Measure](https://zhuanlan.zhihu.com/p/487435847)
3. [Real Variable Function Ch.3 Measurable Function](https://zhuanlan.zhihu.com/p/493842948)
4. [Real Variable Function Ch.4 The Lebesgue Integration](https://zhuanlan.zhihu.com/p/513296172)
5. [Real Variable Function Ch.5 Differentiation and Integration](https://zhuanlan.zhihu.com/p/524968471)

# Chapter 2 Integration

## 2.1 Measurable functions

### 2.1.1 Real/Complex-valued functions

$\bf Def\ (Extended\ real\ line)$

Let $\overline{\mathbb{R}}=\mathbb{R}\cup\{\pm\infty\}$ with the topology making $F(x)=\tan(x),x\in[-\pi/2,\pi/2]$ a homeomorphism $[-\pi/2,\pi/2]\cong\overline{\mathbb{R}}$. Since $\{\infty\}$ and $\{-\infty\}$ are skeletons in $\overline{\mathbb{R}}$, a set $B\in\mathcal{B}_{\overline{\mathbb{R}}}$ is Borel if and only if $B\setminus\{\infty,-\infty\}\in\mathcal{B}_{\overline{\mathbb{R}}}$ is Borel. Hence $\mathcal{B}_{\overline{\mathbb{R}}}$ is generated by $\{[a,\infty]:a\in\mathbb{R}\}$.

<br/><br/>

$\bf Def\ (Measurable\ functions)$

If $(X,\mathcal{M})$ and $(Y,\mathcal{N})$ are measurable spaces, a map $f:X\to Y$ is **$(\mathcal{M},\mathcal{N})$-measurable** if $f^{-1}(E)\in\mathcal{M}$ for all $E\in\mathcal{N}$.

If $Y\in\{\mathbb{R},\overline{\mathbb{R}},\mathbb{C}\}$ and $\mathcal{N}=\mathcal{B}_Y$ is the Borel $\sigma$-algebra (from now on we always assume this is the case unless specified), then a $(\mathcal{M},\mathcal{B}_Y)$-measurable function $f:X\to Y$ is called **measurable** or **$\mathcal{M}$-measurable**. In particular, if $X$ is a topological space and $\mathcal{M}=\mathcal{B}_X$, then $f$ is called **Borel measurable**. If $(X,\mathcal{M})=(\mathbb{R},\mathcal{L})$, then $f$ is called **Lebesgue measurable**.

<br/><br/>

$\bf Prop\ 2.1$

If $\mathcal{N}$ is generated by $\mathcal{E}$, then $f:X\to Y$ is $(\mathcal{M},\mathcal{N})$-measurable if and only if $f^{-1}(E)\in\mathcal{M}$ for all $E\in\mathcal{E}$.

$\bf Prop\ 2.3$

If $f:X\to\mathbb{R}$ or $\overline{\mathbb{R}}$, then TFAE.

1. $f$ is measurable.
2. $\{x\in X:f(x)>a\}\in\mathcal{M}$ for all $a\in\mathbb{R}$.
3. $\{x\in X:f(x)\geq a\}\in\mathcal{M}$ for all $a\in\mathbb{R}$.
4. $\{x\in X:f(x)<a\}\in\mathcal{M}$ for all $a\in\mathbb{R}$.
5. $\{x\in X:f(x)\leq a\}\in\mathcal{M}$ for all $a\in\mathbb{R}$.

<br/><br/>

$\bf Prop$

Suppose $Y=\prod_{a\in A}Y_a$ and $\mathcal{N}_a$ is a $\sigma$-algebra on $Y_a$. Then $\otimes_{a\in A}\mathcal{N}_a$ is the smallest $\sigma$-algebra on $Y$ such that each coordinate map $\pi_a:Y\to Y_a$ is measurable.

> $\it Proof$
> 
> The product $\sigma$-algebra $\otimes_{a\in A}\mathcal{N}_a$ is generated by $\{\pi_a^{-1}(E):a\in A,E\in\mathcal{N}_a\}$, and hence the smallest $\sigma$-algebra containing these sets.

$\bf Prop\ 2.4$

Mapping $f:X\to\prod_{a\in A}Y_a$ is $(\mathcal{M},\mathcal{N})$-measurable if and only if each coordinate map $f_a=\pi_a\circ f:X\to Y_a$ is $(\mathcal{M},\mathcal{N}_a)$-measurable.

> $\it Proof$
>
> The product $\sigma$-algebra $\otimes_{a\in A}\mathcal{N}_a$ is generated by $\{\pi_a^{-1}(E):a\in A,E\in\mathcal{N}_a\}$. Use Prop 2.1 to finish the proof.

$\bf Prop\ 2.5$

If $f:X\to\mathbb{C}$, then TFAE.

1. $f$ is measurable.
2. $\mathrm{Re}(f)$ and $\mathrm{Im}(f)$ are measurable.

> $\it Proof$
>
> By Prop 1.5, $\mathcal{B}_{\mathbb{C}}=\mathcal{B}_{\mathbb{R}^2}=\mathcal{B}_{\mathbb{R}}\otimes\mathcal{B}_{\mathbb{R}}$. It follows from Prop 2.4.

<br/><br/>

### 2.1.2 Simple Functions

$\bf Thm\ 2.10$

1. If $f:X\to[0,\infty]$ is measurable, then there are simple functions $\{\varphi_n\}$ such that $0\leq\varphi_1\leq\varphi_2\leq\dots\leq f$, $\varphi_n\to f$ pointwise, and $\varphi_n\to f$ uniformly on any set where $f$ is bounded.
2. If $f:X\to\mathbb{C}$ is measurable, then there are simple functions $\{\varphi_n\}$ such that $0\leq|\varphi_1|\leq|\varphi_2|\leq\dots\leq |f|$, $\varphi_n\to f$ pointwise, and $\varphi_n\to f$ uniformly on any set where $f$ is bounded.

> $\it Proof$
>
> (1) Let $E_{n,k}=\{x:\frac{k}{2^n}\leq f(x)<\frac{k+1}{2^n}\}$ and $F_n=\{x:f(x)\geq n\}$, then $[0,1]=\bigsqcup_{k=0}^{n2^n-1}E_{n,k}\sqcup F_n$. Consider $\varphi_n=\sum_{k=0}^{n2^n-1}\frac{k}{2^n}\chi_{E_{n,k}}+n\chi_{F_n}$. On the set where $f\leq n$ we have $0\leq f-\varphi_n\leq\frac{1}{2^n}\to 0$.
>
> (2) Consider $\mathrm{Re}(f)^+,\mathrm{Re}(f)^-,\mathrm{Im}(f)^+$ and $\mathrm{Im}(f)^-$.

<br/><br/>

### 2.1.3 Complete Measures

$\bf Prop\ 2.11$

Let $(X,\mathcal{M},\mu)$ be a measure space, then TFAE.

1. $\mu$ is a complete measure on $(X,\mathcal{M})$.
2. If $f$ is measurable and $f=g$ a.e., then $g$ is measurable.
3. If $\{f_n\}$ are measurable and $f_n\to f$ a.e., then $f$ is measurable.

<br/><br/>

## 2.2 Integration of non-negative functions

Fix a measure space $(X,\mathcal{M},\mu)$. Let $L^+$ denote the set of measurable functions $f:X\to[0,\infty]$.

### 2.2.1 Non-negative simple functions

$\bf Def$

If $\varphi\in L^+$ is a simple function, define $\int\varphi d\mu=\sum_{j=1}^{n}a_j\mu(E_j)$ where $\varphi=\sum_{j=1}^{n}a_j\chi_{E_j}$ is the standard representation of $\varphi$. Sometimes we write $\int\varphi$ as a shorthand of $\int\varphi d\mu$ if it is clear from the context. Given $A\in\mathcal{M}$, note that $\varphi\chi_A$ is a simple function, we define $\int_A\varphi=\int\varphi\chi_A$

$\bf Prop\ 2.13$

Let $\varphi,\psi\in L^+$ be simple functions.

1. If $c\geq 0$, then $\int c\varphi=c\int\varphi$.
2. $\int(\varphi+\psi)=\int\varphi+\int\psi$.
3. If $\varphi\leq\psi$, then $\int\varphi\leq\int\psi$.
4. Let, $\lambda(A)\mapsto\int_A\varphi d\mu$, then $\lambda$ is a measure on $\mathcal{M}$.

> $\it Proof$
>
> (4) $\lambda(\varnothing)=\int_\varnothing\varphi=0$. Suppose $A_1,A_2,\dots\in\mathcal{M}$ are disjoint. Then
> $$
\begin{aligned}
\lambda\left(\bigcup_{k=1}^\infty A_k\right)
&=\int\sum_{j=1}^{n}a_j\chi_{E_j}\chi_{\bigcup_{k=1}^\infty A_k}d\mu
=\int\sum_{j=1}^{n}a_j\chi_{\bigcup_{k=1}^\infty(E_j\cap A_k)}d\mu\\
&=\sum_{j=1}^{n}a_j\mu\left(\bigcup_{k=1}^\infty(E_j\cap A_k)\right)
=\sum_{k=1}^{\infty}\sum_{j=1}^{n}a_j\mu\left(E_j\cap A_k\right)
=\sum_{k=1}^{\infty}\lambda(A_k).
\end{aligned}$$ 

<br/><br/>

### 2.2.2 Non-negative measurable functions

$\bf Def$

If $f\in L^+$, define $\int fd\mu=\sup\{\int\varphi d\mu:0\leq\varphi\leq f,\varphi\text{ simple}\}$. Note that the definition of the integration of simples functions coincides, it is well-defined.

<br/><br/>

$\bf Thm\ 2.14\ (Monotone\ convergence\ theorem, MCT)$

If $f_1\leq f_2\leq\dots$ are in $L^+$ and $f=\lim_{n\to\infty}f_n$, then $f\in L^+$ and $\lim_{n\to\infty}\int f_n=\int f$.

> $\it Proof$
>
> ($\geq$) Fix $\varphi$ simple with $0\leq\varphi\leq f$. Fix $\varphi>0$. Let $E_n=\{x:f_n(x)\geq(1-\varepsilon)\varphi(x)\}$. Then $E_1\subset E_2\subset\dots$ and $\bigcup_{n=1}^{\infty}E_n=X$. Also,
> $$\int f_n\geq\int_{E_n}f_n\geq(1-\varepsilon)\int_{E_n}\varphi.$$
> Since $E\mapsto\int_E\varphi$ is a measure,
> $$
\lim_{n\to\infty}\int f_n
\geq(1-\varepsilon)\lim_{n\to\infty}\int_{E_n}\varphi
=(1-\varepsilon)\int_{\bigcup_{n=1}^{\infty}E_n}\varphi
=(1-\varepsilon)\int\varphi.$$
> Send $\varepsilon\to0$, then $\lim_{n\to\infty}\int f_n\geq\int\varphi$. Take supremum, then $\lim_{n\to\infty}\int f_n\geq\int f$.

<!-- $\bf Cor$

By Theorem 2.10, there exist simple functions $0\leq\varphi_1\leq\varphi_2\leq\dots$ such that $f=\lim_{n\to\infty}\varphi_n$. Hence by MCT, $\int f=\lim_{n\to\infty}\int\varphi_n$. Likewise, $\int_E f=\lim_{n\to\infty}\int_E\varphi_n$ for any $E\in\mathcal{M}$. -->

$\bf Thm\ 2.15\ (Termwise\ integration)$

If $\{f_n\}\subset L^+$, then $\int\sum_{n=1}^{\infty}f_n=\sum_{n=1}^{\infty}\int f_n$.

<br/><br/>

$\bf Prop$

Let $f,g\in L^+$.

1. If $c\geq 0$, then $\int cf=c\int f$.
2. $\int(f+g)=\int f+\int g$.
3. If $f\leq g$, then $\int f\leq\int g$.
4. Let $\lambda(E)=\int_E fd\mu$, then $\lambda$ is a measure on $\mathcal{M}$. Moreover, $\int gd\lambda=\int fgd\mu$.
5. (Prop 2.16) $\int f=0$ if and only if $f=0$ a.e..
6. (Prop 2.20) If $\int<\infty$, then $\{x:f(x)=\infty\}$ is a null set, and $\{x:f(x)>0\}$ is $\sigma$-finite.

> $\it Proof$
>
> (4) $\lambda(\varnothing)=0$. Suppose $A_1,A_2,\dots\in\mathcal{M}$ are disjoint. Then by Theorem 2.15
> $$
\begin{aligned}
\lambda\left(\bigcup_{k=1}^\infty A_k\right)
&=\int\chi_{\bigcup_{k=1}^\infty A_k}fd\mu
=\int\sum_{k=1}^{\infty}\chi_{A_k}fd\mu\\
&=\sum_{k=1}^{\infty}\int\chi_{A_k}fd\mu
=\sum_{k=1}^{\infty}\lambda(A_k).
\end{aligned}$$
> Hence $\lambda$ is indeed a measure. For the second assertion, first check the case when $g$ a non-negative simple function. And then approximate general $g\in L^+$ by increasing non-negative simple functions $\{\varphi_n\}$. Then $fg_n\uparrow fg$. Use MCT twice, then
> $$
\int\varphi_nd\lambda\to\int gd\lambda
\quad\text{and}\quad
\int f\varphi_nd\mu\to\int fgd\mu.$$
> Then
> $$
\int fgd\mu=\lim\int f\varphi_nd\mu=\lim\int \varphi_nd\lambda=\int gd\lambda.$$
> 
> (5) $(\Rightarrow)$ Note that $\{x:f>0\}=\bigcup_{k=1}^\infty\{x:f>\frac{1}{k}\}$. Use Chebyshev's inequality to show $\mu(\{x:f>0\})=0$. $(\Leftarrow)$ it is obviously true when $f$ is a non-negative simple function. Then approximate general $f\in L^+$ by simple functions.
>
> (6) For the first assertion, note that $\{x:f=\infty\}=\bigcup_{k=1}^\infty\{x:f>k\}$. Use Chebyshev's inequality to show $\mu(\{x:f=\infty\})=0$. For the second assertion, note that $\{x:f>0\}=\bigcup_{k=1}^\infty\{x:f>\frac{1}{k}\}$ and use Chebyshev's inequality to show every $\mu(\{x:f>\frac{1}{k}\})<\infty$.

<br/><br/>

$\bf Thm\ 2.18\ (Fatou's\ Lemma)$

If $\{f_n\}\subset L^+$, then $\int\liminf_{n\to\infty}f_n\leq\liminf_{n\to\infty}\int f_n$.

> $\it Proof$
>
> Use $\liminf_{n\to\infty}f_n=\lim_{n\to\infty}\inf_{k\geq n}f_k$ with MCT.

<br/><br/>

## 2.3 Integration of complex functions

### 2.3.1 The space Tilde $L^1$

Fix a measure space $(X,\mathcal{M},\mu)$. Let $L^+$ denote the set of measurable functions $f:X\to[0,\infty]$.

$\bf Def$

1. A measurable function $f:X\to\mathbb{R}$ is **integrable** if $\int|f|<\infty$. In this case, we define $\int f=\int f^+-\int f^-$.
2. A measurable function $f:X\to\mathbb{C}$ is **integrable** if $\int|f|<\infty$. In this case, we define $\int f=\int\mathrm{Re}f-i\int\mathrm{Im}f$.

$\bf Def$

Note that the set of integrable $\mathbb{R}$-valued (resp. $\mathbb{C}$-valued) functions on $X$ is a $\mathbb{R}$ (resp. $\mathbb{C}$) vector space. Define $\widetilde{L}^1(X,\mathcal{M},\mu)$ to be the vector space of integrable $\mathbb{C}$-valued functions on $X$. We write $\widetilde{L}^1$ instead when the context is clear.

<br/><br/>

$\bf Prop$

Let $f,g\in\widetilde{L}^1$.

1. (Prop 2.21) If $c\geq 0$, then $\int cf=c\int f$.
2. (Prop 2.21) $\int(f+g)=\int f+\int g$.
3. (Prop 2.22) $|\int f|\leq\int|f|$.
4. (Prop 2.23) $\{x:f(x)\neq0\}$ is $\sigma$-finite.
5. (Prop 2.23) TFAE.
   1. $\int_E f=\int_E g$ for all $E\in\mathcal{M}$.
   2. $\int|f-g|=0$.
   3. $f=g$ a.e..

> $\it Proof$
>
> (3) Fix $z\in\mathbb{C}$ with $|z|=1$ and $|\int f|=z\int f$.
>
> (4) Note that $\{x:f\neq 0\}=\{x:|f|\neq 0\}$. Use Prop 2.20 since $|f|\in L^+$.
>
> (5) $(ii\Leftrightarrow iii)$ follows from Prop 2.16. $(ii\Rightarrow i)$ follows from (1). $(i\Rightarrow ii)$ Let $u=\mathrm{Re}(f-g)$, $v=\mathrm{Im}(f-g)$. Let $E^\pm=\{x:u^\pm>0\}$, $F^\pm=\{x:v^\pm>0\}$. Then
> $$
\begin{aligned}
\int|f-g|
&\leq\int|u|+|v|=\int u^++u^-+v^++v^-\\
&=\int_{E^+} u^++\int_{E^-}u^-+\int_{F^+}v^++\int_{F^-}v^-\\
&=\int_{E^+} u-\int_{E^-}u+\int_{F^+}v-\int_{F^-}v\\
&=\mathrm{Re}\left(\int_{E^+}(f-g)-\int_{E^-}(f-g)\right)\\
&+\mathrm{Im}\left(\int_{E^+}(f-g)-\int_{E^-}(f-g)\right)=0.
\end{aligned}$$

<br/><br/>

### 2.3.2 The space $L^1$

$\bf Def$

Define an equivalence class on $\widetilde L^1$ by $f\sim g\Leftrightarrow f=g$ a.e., and define $L^1(X,\mathcal{M},\mu)=\widetilde L^1/\sim$. We write $L^1$ instead when the context is clear. It follows that $L^1$ is a $\mathbb{C}$ vector space with operations

$$
[f]+[g]=[f+g]\quad\text{and}\quad c[f]=[cf].
$$

Note that the integral $\int[f]=\int f$ is well-defined and linear on $L^1$, by Prop 2.23, $\rho([f],[g])=\int|f-g|.$ is a well-defined distance on $L^1$. Later we will show $\rho$ is complete, hence **$L^1$ is a Banach space.**

(From now on, we just write $f$ to mean the equivalence class of $f$ in $L^1$ for convenience.) A sequence $\{f_n\}$ in $L^1$ **converges in $L^1$** to $f\in L^1$ if $\int|f_n-f|\to0$.

<br/><br/>

$\bf Prop$

Let $(X,\overline{\mathcal{M}},\overline{\mu})$ be the completion of $(X,\mathcal{M},\mu)$. Then $\widetilde{L}^1(X,\mathcal{M},\mu)\subset\widetilde{L}^1(X,\overline{\mathcal{M}},\overline{\mu})$ and the inclusion map descends to a bijection $F:L^1(X,\mathcal{M},\mu)\to L^1(X,\overline{\mathcal{M}},\overline{\mu})$. Moreover $f$ is a homeomorphism。

> $\it Proof$
>
> Omit.

$\bf Rmk$

Since $L^1(X,\mathcal{M},\mu)$ and $L^1(X,\overline{\mathcal{M}},\overline{\mu})$ are homeomorphic, from now on we always assume $\mu$ is complete.

<br/><br/>

$\bf Thm\ 2.24\ (Dominated\ convergence\ theorem)$

If $\{f_n\}\subset L^1$, $f_n\to f$ a.e. and $|f_n|\leq g$ a.e. for some $g\in L^1$ for all $n$, then $f\in L^1$ and $\lim_{n\to\infty}\int f_n=\int f$. Moreover, $\{f_n\}$ converges to $f$ in $L^1$.

> $\it Proof$
>
> Since $\mu$ is complete, $f$ is measurable by Prop 2.11. Also $|f|\leq g$ a.e. and hence $\int |f|\leq\int g<\infty$. So $f\in L^+$.
>
> By taking real and imaginary parts, we may assume $f_n$ and $f$ are real-valued. Then $g+f_n\geq 0$ a.e. and $g-f_n\geq 0$ a.e.. Apply Fatou's lemma to finish the proof.
>
> For the last assertion, apply DCT to $f_n-f\to0$ since $|f_n-f|\leq 2|f|\in L^1$.

<br/><br/>

$\bf Thm\ 2.25$

Suppose $\{f_n\}\subset L^1$ and $\sum_n\int|f_n|<\infty$. Then $\sum_n f_n$ converges a.e. to a function in $L^1$ and $\int\sum_n f_n=\sum_n\int f_n$.

$\bf Rmk$

It implies that the norm $\|f\|=\int|f|$ on $L^1$ is complete. Hence $L^1$ is a Banach space. (See Exercise 1.4.7 and Exercise 1.2.2 of Zhang Gongqing’s “Lecture Notes on Functional Analysis”)

<br/><br/>

$\bf Thm\ 2.26$

If $f\in L^1$ and $\varepsilon>0$, then there is an integrable simple function $\varphi=\sum a_j\chi_{E_j}$ such that $\int|f-\varepsilon|d\mu<\varepsilon$. Hence integrable simple functions are dense in $L^1$.

Moreover, if $X=\mathbb{R}$ and $\mu$ is a L-S measure, then we may assume that each $E_j$ is a finite union of bounded open intervals. In addition, there is a continuous function $g$ with bounded support such that $\int|f-g|d\mu$.

> $\it Proof$
>
> Omit.

<br/><br/>

## 2.4 Modes of convergence